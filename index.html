<html>

<head>
    <title>Rock Paper Scissors Challenge</title>
    <script src="/socket.io/socket.io.js">
    </script>
    <script>
    var choice = function(data) {
        socket.emit('choice', data);
    };

    var toggle = function(id, toggle) {
        var element = document.getElementById(id);
        element.style.visibility = toggle;
    };

    var setText = function(id, text) {
        var element = document.getElementById(id);
        element.innerHTML = text;
    };
    var appendText = function(id, text) {
        var element = document.getElementById(id);
        element.innerHTML = element.innerHTML + "</br>" + text;
    };
    var socket = io.connect();
    socket.on('playerid', function(data) {
        console.log(data);
        var line = "Your player id is: " + data.content;
        appendText('debug', line);
        socket.emit('ready', 'ready');
    });

    socket.on('wait', function(data) {
        console.log(data);
        setText('wait', data.content);
    });

    socket.on('choose', function() {
        setText('result', '');
        toggle('result', 'hidden');
        setText('counter', '');
        toggle('counter', 'hidden');
        toggle('game', 'visible');
        // var game = document.getElementById('game');
        // game.style.visibility = "visible";
        toggle('wait', 'hidden');
        // var wait = document.getElementById('wait');
        // wait.style.visibility = "hidden";
    });

    socket.on('result', function(data) {
        toggle('game', 'hidden');
        setText('result', data.content);
        toggle('result', 'visible');
        var secs = 5;

        updateText();

        function updateText() {
                // var counter = document.getElementById('counter');
                var line = 'You will be placed in queue after ' + secs + ' seconds';
                toggle('counter','visible');
                setText('counter', line);
                secs--;
                if (secs > 0) {
                    setTimeout(updateText, 1000);
                }
            }
            // counter.style.visibility = 'hidden';
    });
    </script>
</head>

<body>
    <span id='status'>
    </span>
    </br>
    <span id='wait'></span>
    </br>
    <span id='game' style="visibility:hidden">
        <a onClick="choice('rock')" href="#">Rock</a>
        <a onClick="choice('paper')" href="#">Paper</a>
        <a onClick="choice('scissors')" href="#">Scissors</a>
    </span>
    </br>
    <span id='result' style "visibility:hidden">
    </span>
    </br>
    <span id='counter'>
    </span>
    <span id='debug'>
    </span>
</body>

</html>
